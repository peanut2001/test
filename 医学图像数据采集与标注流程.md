# 医学图像数据采集与标注流程文档

## 📋 概述

本文档详细描述了医学图像数据采集管理系统中从原始图像上传到生成结构化诊断数据的完整工作流程。该系统支持多种医学图像类型，提供集成化的标注工具，确保为医学AI模型提供高质量的训练数据。

## 🔄 完整工作流程

### 第一阶段：数据采集页面

#### 1. 图像上传
- **支持格式**：JPEG、PNG、DICOM等医学图像格式
- **图像类型**：乳腺超声、CT、MRI、X光等
- **功能特点**：
  - 拖拽上传或点击选择
  - 实时图像预览
  - 自动显示文件名和基本信息

#### 2. 基础信息录入
- **检查部位选择**：
  - 乳腺
  - 肺部
  - 腹部
  - 头颅
  - 骨骼
  - 其他

- **切面类型选择**：
  - 横断面（轴位）
  - 矢状面
  - 冠状面
  - 斜切面

- **病灶类型预设**：
  - 结节
  - 肿块
  - 钙化
  - 囊肿
  - 其他

#### 3. 标注选项决策
- **标注选择**：用户可选择是否进行图像标注
- **工作流集成**：选择标注后自动跳转到图像分析页面
- **数据传递**：图像和基础信息自动传递到标注界面

### 第二阶段：图像分析页面（标注工作）

#### 4. 标注工具操作
- **可用工具**：
  - 🔲 **矩形标注框**：标记病灶区域
  - ⭕ **圆形标注**：标记圆形病灶
  - ➡️ **箭头指示点**：指向关键特征
  - 📝 **文本标注框**：添加文字说明
  - ✏️ **自由绘制**：手绘标记

- **操作功能**：
  - 实时标注预览
  - 撤销/重做操作
  - 标注列表管理
  - 标注数量统计

#### 5. 标注管理
- **标注列表**：右侧面板显示所有标注
- **编辑功能**：可编辑、删除单个标注
- **批量操作**：清除所有标注、导出标注数据

#### 6. 标注保存与返回
- **保存机制**：
  - 点击保存按钮保存当前标注
  - 显示保存成功通知
  - 标注数据存储到sessionStorage

- **自动返回流程**：
  - 保存成功后自动询问是否返回数据采集页面
  - 符合用户偏好的集成工作流设计
  - 标注数据自动传递回数据采集页面

### 第三阶段：完成诊断数据录入

#### 7. 图像特征分析
- **特征词条系统**：
  - 边界特征：清晰、模糊、不规则
  - 回声特征：均匀、不均匀、无回声
  - 形态特征：规则、不规则、分叶状
  - 其他特征：钙化灶、血流信号等

- **预设标签**：提供常用特征标签快速选择
- **自定义输入**：支持手动添加特定特征描述

#### 8. 诊断联想录入
- **联想词条**：
  - 考虑良性结节
  - 恶性可能性
  - 需要进一步检查
  - 典型良性表现
  - 需要病理确诊

- **动态添加**：支持添加多个诊断联想
- **预设选项**：提供常见诊断联想快速选择

#### 9. 诊断依据记录
- **依据类型**：
  - 影像学特征
  - 病史信息
  - 实验室检查
  - 临床表现

- **具体依据**：
  - 无钙化表现
  - 血流信号正常
  - 边界清晰完整
  - 淋巴结肿大
  - 增强扫描异常

#### 10. 诊断结果确定
- **诊断分类**：
  - ✅ **正常**：无异常发现
  - 🟢 **良性**：良性病变
  - 🔴 **恶性**：恶性病变
  - 🟡 **未定**：需要进一步检查
  - ⚪ **其他**：其他情况

- **条件显示**：
  - 良性/恶性：显示详细诊断依据输入框
  - 未定/其他：显示备注说明输入框

#### 11. 数据验证与提交
- **表单验证**：
  - 图像文件必须上传
  - 至少添加一个图像特征
  - 至少添加一个诊断联想
  - 至少添加一个诊断依据
  - 必须选择诊断分类

- **数据提交**：验证通过后生成完整诊断数据记录

## 📊 最终诊断数据结构

```json
{
  "id": "唯一标识符",
  "fileName": "图像文件名",
  "imagePreview": "图像预览URL",
  "basicInfo": {
    "bodyPart": "检查部位",
    "crossSection": "切面类型",
    "lesionType": "病灶类型"
  },
  "annotations": [
    {
      "id": "标注ID",
      "type": "标注类型",
      "coordinates": "坐标信息",
      "text": "标注文本",
      "timestamp": "标注时间"
    }
  ],
  "imageFeatures": [
    "边界清晰",
    "回声均匀",
    "形态规则"
  ],
  "diagnosticThinking": [
    "考虑良性结节",
    "需要随访观察"
  ],
  "diagnosticBasis": [
    "无钙化表现",
    "血流信号正常"
  ],
  "diagnosisResult": {
    "type": "诊断分类",
    "typeText": "分类中文描述",
    "detailedDiagnosis": "详细诊断内容"
  },
  "metadata": {
    "timestamp": "创建时间",
    "status": "处理状态",
    "operator": "操作者信息"
  }
}
```

## 🎯 系统特点与优势

### 集成化工作流
- **无缝衔接**：标注和数据采集流程完全集成
- **自动跳转**：标注完成后自动返回主流程
- **数据传递**：各阶段数据自动传递，无需重复输入

### 用户体验优化
- **直观界面**：现代化的用户界面设计
- **操作便捷**：拖拽上传、快速标签选择
- **实时反馈**：操作状态实时显示

### 数据质量保证
- **表单验证**：确保数据完整性和准确性
- **结构化存储**：标准化的数据格式
- **版本控制**：支持数据修改和历史记录

### 可扩展性
- **模块化设计**：各功能模块独立，便于扩展
- **标准接口**：支持与其他系统集成
- **配置灵活**：支持自定义标签和分类

## 🔧 技术实现要点

### 前端技术
- **HTML5 Canvas**：图像标注功能实现
- **JavaScript ES6+**：现代化前端开发
- **CSS3**：响应式界面设计
- **LocalStorage/SessionStorage**：本地数据存储

### 数据处理
- **FileReader API**：图像文件读取和预览
- **JSON格式**：结构化数据存储
- **表单验证**：客户端数据验证
- **状态管理**：应用状态统一管理

## 📈 应用价值

### 医学AI训练
- **高质量数据**：结构化的标注数据
- **标准格式**：统一的数据格式便于模型训练
- **丰富标签**：多维度的特征标签

### 临床应用
- **诊断辅助**：标准化的诊断流程
- **质量控制**：数据验证和审核机制
- **知识积累**：诊断经验的数字化存储

### 科研支持
- **数据统计**：支持大规模数据分析
- **模式识别**：发现诊断规律和模式
- **效果评估**：诊断准确性评估

## 🚀 未来发展方向

### 功能增强
- **AI辅助标注**：自动识别和预标注
- **多人协作**：支持多专家协同标注
- **质量评分**：标注质量自动评估

### 技术升级
- **云端存储**：数据云端同步和备份
- **移动端支持**：移动设备标注功能
- **实时协作**：实时多人协作标注

### 标准化
- **DICOM支持**：完整的医学图像标准支持
- **HL7集成**：医疗信息标准集成
- **国际标准**：符合国际医学信息标准

---

*本文档版本：v1.0*  
*最后更新：2025年7月11日*  
*文档维护：医学图像数据采集管理系统开发团队*
